{
    "collab_server" : "",
    "contents" : "rm(list = ls())\n\n# install.packages(\"readxl\", dependencies = T)\n# install.packages(\"reshape2\", dependencies = T)\n# install.packages(\"car\", dependencies = T)\nlibrary(readxl)\nlibrary(reshape2)\nlibrary(car)\n\n## Set working directory\n# getwd()  # See where current directory is and change it\n# setwd()\n\n## Pre-Processing Data\ndf <- read_excel(\"PLEFinalProjectData.xlsx\", \"Purchasing Survey Data\")\nnames(df) <- gsub(\" \", \".\", names(df))  # Replace spaces with '.' in column names\n\n## Create formulas for linear model\ncreateFormula <- function(df, target) {\n  exclude <- names(df) %in% target  # logical vector for excluding target var from data.frame\n  predictors <- paste(names(df)[!exclude], collapse = \"+\")  # Predictors of target\n  return(as.formula(paste(target, \" ~ \", predictors, sep = \"\")))  # Return formula for lm()\n}\nform.satis <- createFormula(df, \"Satisfaction.Level\")  # Create formula 1\nform.usage <- createFormula(df, \"Usage.Level\")  # Create formula 2\n\n## Build Regression Models\nfit.satis <- lm(form.satis, data = df)\nfit.usage <- lm(form.usage, data = df)\n\n## Assess model on satisfaction levels\nsummary(fit.satis)\nanova(fit.satis)\nvif(fit.satis)\nvcov(fit.satis)\n\n## Assess model on usage level\nsummary(fit.usage)\nanova(fit.usage)\nvif(fit.usage)\nvcov(fit.satis)\n\n## Produce visual metrics\npng(\"output/OLSPlotsSatis.png\")\n  layout(matrix(c(1,2,3,4),2,2))\n    plot(fit.satis)\n  layout(matrix(c(1,1)))\ndev.off()\npng(\"output/OLSPlotsUsage.png\")\n  layout(matrix(c(1,2,3,4),2,2))\n    plot(fit.usage)\n  layout(matrix(c(1,1)))\ndev.off()\n",
    "created" : 1493740398087.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "707877858",
    "id" : "F2EEAC52",
    "lastKnownWriteTime" : 1493831874,
    "last_content_update" : 1493831874754,
    "path" : "C:/Users/yalot/OneDrive/WM/Business Classes/BUAD467 Applied Predictive Analytics/FinalProject/Analysis/ols.R",
    "project_path" : "ols.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}