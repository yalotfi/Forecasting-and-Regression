{
    "collab_server" : "",
    "contents" : "rm(list = ls())\n\n# install.packages(\"readxl\", dependencies = T)\n# install.packages(\"forecast\", dependencies = T)\nlibrary(readxl)\nlibrary(forecast)\n\ndf <- read_excel(\"PLEFinalProjectData.xlsx\", \"Tractor Sales\")\nminDate <- as.numeric(c(min(substr(df$Month, 1, 4)), 1))   # (2010, 1)\nmaxDate <- as.numeric(c(max(substr(df$Month, 1, 4)), 12))  # (2014, 12)\n\n## Create Time-Series Object Matrix: (60, 6)\ndata.ts <- ts(data = df[ ,2:7]\n              , start = minDate\n              , end = maxDate\n              , frequency = 12)\nrm(minDate, maxDate)\n\n## Visualize Time-Series\npng(\"output/seriesPlots.png\")\n  plot(data.ts, main = \"Time Series By Region\")  # Plot time series sequences\ndev.off()\n\n## Seasonal Decomposition Charts\nfor (i in 1:ncol(data.ts)) {\n  png(filename = paste(\"output/decompCharts\"\n                       , colnames(data.ts)[i]\n                       , \".png\"\n                       , sep = \"\"))\n  decomps <- stl(data.ts[ ,i], s.window = \"period\")\n  chartTitle <- paste(\"Region: \", colnames(data.ts)[i], sep = \"\")\n  plot(decomps, main = chartTitle)\n  dev.off()\n}\nrm(i, decomps, chartTitle)\n\n## Use Holt-Winters for Forecasts on Level, Trend, and Seasonality\nmodel.NA <- hw(log(data.ts[, \"NA\"]), initial = \"optimal\", h = 60)\nmodel.Pac <- hw(data.ts[, \"Pac\"], initial = \"optimal\", h = 60)\nmodel.World <- hw(log(data.ts[, \"World\"]), initial = \"optimal\", h = 60)\n\n## Use Double-Exponential Smoothing fore Forecasts on Level and Seasonality\nmodel.Eur <- hw(data.ts[, \"Eur\"], initial = \"optimal\", h = 60, gamma = NULL)\nmodel.SA <- hw(data.ts[, \"SA\"], initial = \"optimal\", h = 60, gamma = NULL)\nmodel.China <- hw(data.ts[, \"China\"], initial = \"optimal\", h = 60, gamma = NULL)\n\n# Store accuracy metrics for each model\naccuracy.matrix <- t(rbind(accuracy(model.NA),\n                           accuracy(model.Pac),\n                           accuracy(model.World),\n                           accuracy(model.Eur),\n                           accuracy(model.SA),\n                           accuracy(model.China)))\ncolnames(accuracy.matrix) <- c(\"NA\", \"Pac\", \"World\", \"Eur\", \"SA\", \"China\")\n\n# Plot Forecasts\npng(\"output/FinalForecasts.png\", width = 900, height = 600)\n  layout(matrix(c(1,2,3,4,5,6),2,3))\n    plot(model.NA, main = \"NA: Holt-Winters'\")\n    plot(model.Pac, main = \"Pac: Holt-Winters'\")\n    plot(model.SA, main = \"SA: Double-Smoothing\")\n    plot(model.China, main = \"China: Double-Smoothing\")\n    plot(model.Eur, main = \"Eur: Double-Smoothing\")\n    plot(model.World, main = \"World: Holt-Winters'\")\n  layout(matrix(c(1,1)))\ndev.off()\n\n\n# Plot MAE Errors by Region\npng(\"output/MAE.png\")\n  barplot(accuracy.matrix[\"MAE\", ]\n          , main = \"MAE Errors by Region\"\n          , xlab = \"Region\", ylab = \"MAE\")\ndev.off()\n",
    "created" : 1493740540227.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1338658995",
    "id" : "5E436073",
    "lastKnownWriteTime" : 1493831986,
    "last_content_update" : 1493831986392,
    "path" : "C:/Users/yalot/OneDrive/WM/Business Classes/BUAD467 Applied Predictive Analytics/FinalProject/Analysis/forecast.R",
    "project_path" : "forecast.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}